Ваша цель в данной задаче — реализовать симуляцию объединениятаблиц в базе данных.
В базе данных есть n таблиц, пронумерованных от 1 до n, над одним и тем же множеством столбцов (атрибутов). Каждая таблица содержит либо реальные записи в таблице, либо символьную ссылку на
другую таблицу. Изначально все таблицы содержат реальные записи,
и i-я таблица содержит ri записей. Ваша цель — обработать m запросов типа (destinationi, sourcei):
1. Рассмотрим таблицу с номером destinationi
. Пройдясь по цепочке символьных ссылок, найдём номер реальной таблицы, на которую ссылается эта таблица:
пока таблица destinationi содержит символическую ссылку:
destinationi ← symlink(destinationi)
2. Сделаем то же самое с таблицей sourcei.
3. Теперь таблицы destinationi и sourcei содержат реальные записи. Если destinationi 6= sourcei, скопируем все записи из таблицы
sourcei в таблицу destinationi, очистим таблицу sourcei и пропишем в неё символическую ссылку на таблицу destinationi.
4. Выведем максимальный размер среди всех n таблиц. Размером таблицы называется число строк в ней. Если таблица содержит символическую ссылку, считаем её размер равным нулю.
Формат входа.
Первая строка содержит числа n и m — число таблици число запросов, соответственно. Вторая строка содержит n целых чисел r1, . . . , rn — размеры таблиц. Каждая из последующих
m строк содержит два номера таблиц destinationi и sourcei, которые необходимо объединить.
Формат выхода.
Для каждого из m запросов выведите максимальный размер таблицы после соответствующего объединения.
Ограничения.
1 ≤ n, m ≤ 100 000; 0 ≤ ri ≤ 10 000;
1 ≤ destinationi, sourcei ≤ n.